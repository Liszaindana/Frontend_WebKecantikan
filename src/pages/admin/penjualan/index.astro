---
import AdminLayout from "../../../layouts/adminLayout.astro";

const resp = await fetch("http://localhost:3000/orders");
const sales = await resp.json();
---

<AdminLayout title="Data Penjualan">
    <div class="glass-panel section">
        <div class="header-actions">
            <!-- No create button for sales usually, transactions happen from frontend -->
            <button class="btn btn-primary">Export Data</button>
        </div>

        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Order ID</th>
                        <th>Tanggal</th>
                        <th>Pelanggan ID</th>
                        <th>Total</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    {
                        sales.map((sale) => (
                            <tr>
                                <td class="primary-text">{sale.ORDER_ID}</td>
                                <td>
                                    {new Date(
                                        sale.ORDER_DATE,
                                    ).toLocaleDateString("id-ID")}
                                </td>
                                <td>{sale.CUST_ID || "Guest"}</td>
                                <td>
                                    Rp {sale.TOTAL?.toLocaleString("id-ID")}
                                </td>
                                <td>
                                    <a
                                        href={`/admin/penjualan/${sale.ORDER_ID}`}
                                        class="action-btn btn-edit"
                                        style="text-decoration: none;"
                                    >
                                        Detail
                                    </a>
                                </td>
                            </tr>
                        ))
                    }
                </tbody>
            </table>
        </div>
    </div>
</AdminLayout>

<style>
    .section {
        padding: 1.5rem;
    }
    .primary-text {
        color: var(--color-primary);
        font-weight: 600;
    }
</style>
